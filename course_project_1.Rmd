---
title: "Reproducible Research: Peer Assessment 1"
author: "Carlos Guadi√°n"
date: "12/2/2021"
output: 
  github_document:
    keep_html: true
    toc: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Load & process data
First load data into `activity` variable
```{r read data, echo=TRUE}
activity <- read.csv("~/RepData_PeerAssessment1/activity.csv")
```

Check for correct class of variables
```{r check data again, echo=TRUE}
str(activity)
```

`date` variable has class character, and it has to be "Date".
```{r convert date, echo=TRUE}
activity$date <- as.Date(activity$date)
```

Check again
```{r check data, echo=TRUE}
str(activity)
```

## What is mean total number of steps taken per day?
**Calculate the total number of steps taken per day**

To calculate the total number of steps taken per day first I have to group data by day. To do this we need the `tidyverse` library.
```{r group data, echo=TRUE}
library(tidyverse)
steps_by_day <- activity %>%
  group_by(date) %>%
  summarize(total_steps = sum(steps))
head(steps_by_day)
```

**Make a histogram of the total number of steps taken each day**

Making histogram with base system
```{r histogram,fig.height=5,fig.cap="Histogram of total steps by day", echo=TRUE}
with(steps_by_day, {
  hist(total_steps, col = "green", main = "Histogram total steps by day", xlab = "Total steps")
})
```

**Calculate and report the mean and median of the total number of steps taken per day**
Using two ways to get mean and median. With `summary` and `mean()` & `median()`
```{r mean median, echo=TRUE}
summary(steps_by_day$total_steps)
mean(steps_by_day$total_steps, na.rm = TRUE)
median(steps_by_day$total_steps, na.rm = TRUE)
```

## What is the average daily activity pattern?
**Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)**

Group by interval to get average number of steps by interval
```{r group interval, echo= TRUE}
steps_by_interval <- activity %>%
  group_by(interval) %>%
  summarize(average_steps = mean(steps, na.rm = TRUE))
head(steps_by_interval)
```

Plotting time serie
```{r time serie,fig.cap="Average number of steps by 5 min. interval", echo=TRUE}
with(steps_by_interval, {
plot(interval, average_steps, type = "l",
     main = "Average number of steps by 5 min. interval", xlab = "5 minutes Interval", ylab = "Average Steps", col = "blue", lwd = 1, frame.plot=FALSE, xaxt="n")
  axis(1, at = seq(00, 2355, by = 50), las=2)
  })
```

**Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?**
Getting the interval filtering with `which.max()`
```{r interval max, echo=TRUE}
max_steps_interval <- steps_by_interval[which.max(steps_by_interval$average_steps),]
max_steps_interval
```
Adding vertical line to check if interval 835 has the maximum steps in graph
```{r time serie max,fig.cap="Average number of steps by 5 min. interval", echo=TRUE}
with(steps_by_interval, {
plot(interval, average_steps, type = "l",
     main = "Average number of steps by 5 min. interval", xlab = "5 minutes Interval", ylab = "Average Steps", col = "blue", lwd = 1, frame.plot=FALSE, xaxt="n")
  axis(1, at = seq(00, 2355, by = 50), las=2)
  abline(v=835, col = "red", lwd = 1)
  })
```

## Imputing missing values
Note that there are a number of days/intervals where there are missing values (**coded as NA**). The presence of missing days may introduce bias into some calculations or summaries of the data.

**Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NAs)**
The only variable in `activity` dataset with NAs is `steps`, we can check this with `summary`, and then we can confirm with `sum(is.na())`
```{r missing values, echo=TRUE}
summary(activity)
sum(is.na(activity$steps))
```

**Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.**
